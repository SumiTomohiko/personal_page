<!DOCTYPE html>
<html>
  <head>
    @include("head.html")@
  </head>
  <body>
    @include("header.html")@
    <h1>@page_title@</h1>
    <section>
      <h1>Description</h1>
      <p>I tryed encription of root directory at FreeBSD. This article describes
      what I did.</p>
    </section>
    <section>
      <h1>Targets</h1>
      <section>
        <h1>PC</h1>
        <p>PC was a laptop of Dell Latitude x300. Its spec is;</p>
        <table>
          <tr><th>CPU</th><td>Intel Pentium M 1.40GHz</td></tr>
          <tr><th>HDD</th><td>80Gbyte</td></tr>
        </table>
      </section>
      <section><h1>OS</h1><p>OS was FreeBSD 8.2.</p></section>
    </section>
    <section>
      <h1>What I Needed</h1>
      <p>I needed the following tools.</p>
      <ol>
        <li>livefs which is CD-ROM burned with
        FreeBSD-8.2-RELEASE-i386-livefs.iso.</li>
        <li>disc1 which is CD-ROM burned with
        FreeBSD-8.2-RELEASE-i386-disc1.iso.</li>
        <li>Two CD-ROM drives. One was for livefs to boot, second one was for
        installing system with disc1. Two discs were used at same time. But
        disc1 could be non CD-ROM media. For example, a USB memory including
        contents of disc1.</li>
        <li>One USB memory to save log.</li>
      </ol>
    </section>
    <section>
      <h1>Overview</h1>
      <section>
        <h1>Cryptgraphic Subsystem</h1>
        <p>I used geli without master keys. Only a passphrase was given.</p>
      </section>
      <section>
        <h1>Slices and Partitions</h1>
        <p>I split HDD into two slices.</p>
        <table>
          <thead><tr><th>Slice</th><th>Size [Mbyte]</th></tr></thead>
          <tbody>
            <tr>
              <td><code>/dev/ad0s1</code></td><td class="numeric">256</td>
            </tr>
            <tr><td><code>/dev/ad0s2</code></td><td>Rest of All</td></tr>
          </tbody>
        </table>
        <p><code>/dev/ad0s1</code> is for boot. This slice was not encrypted,
        and has one partition of UTF2. The partition includes <code>/boot</code>
        directory and <code>/etc/fstab</code>.</p>
        <p>I encrypted <code>/dev/ad0s2</code>. This slice has all partitions
        needed by FreeBSD including swap. Attaching this slice gave a slice of
        <code>/dev/ad0s2.eli</code>. I made the following partitions in this
        slice.</p>
        <table>
          <thead>
            <tr>
              <th>Filesystem</th>
              <th>Type</th>
              <th>Size [byte]</th>
              <th>Mounted on</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>/dev/ad0s2.elia</code></td>
              <td>swap</td>
              <td class="numeric">TODO</td>
              <td></td>
            </tr>
            <tr>
              <td><code>/dev/ad0s2.elib</code></td>
              <td>UFS2</td>
              <td class="numeric">TODO</td>
              <td><code>/</code></td>
            </tr>
            <tr>
              <td><code>/dev/ad0s2.elid</code></td>
              <td>UFS2</td>
              <td class="numeric">TODO</td>
              <td><code>/tmp</code></td>
            </tr>
            <tr>
              <td><code>/dev/ad0s2.elie</code></td>
              <td>UFS2</td>
              <td class="numeric">TODO</td>
              <td><code>/var</code></td>
            </tr>
            <tr>
              <td><code>/dev/ad0s2.elif</code></td>
              <td>UFS2</td>
              <td class="numeric">TODO</td>
              <td><code>/usr</code></td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section>
      <h1>What I Did</h1>
      <section>
        <h1>Booted from livefs and Run Fixit</h1>
      </section>
      <section>
        <h1>Started Logging</h1>
      </section>
      <section>
        <h1>Made Slices and Partitions</h1>
      </section>
      <section>
        <h1>Encrypted</h1>
      </section>
      <section>
        <h1>Made Partitions in the Encrypted Slice</h1>
      </section>
      <section>
        <h1>Installed System</h1>
      </section>
      <section>
        <h1>Rebooted and Done</h1>
      </section>
    </section>
    <section>
      <h1>Troubles I Had</h1>
      <section>
        <h1><code>fdisk -BI /dev/ad0</code> Didn't Work</h1>
        <p>Use <code>gpart(8)</code>.</p>
      </section>
    </section>
    <section>
      <h1>References</h1>
      <ul>
        <li><a href="https://catbull.com/wiki/index.php/FreeBSD_Encrypted_Root">
        FreeBSD Encrypted Root - catbull multimedia wiki</a></li>
      </ul>
    </section>
  </body>
</html>
<!--
vim: tabstop=2 shiftwidth=2 expandtab softtabstop=2
-->
